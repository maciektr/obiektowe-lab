package agh.cs.lab.integration;

import agh.cs.lab.*;
import org.junit.After;
import org.junit.Assert;
import org.junit.Before;
import org.junit.Test;

import java.io.ByteArrayOutputStream;
import java.io.PrintStream;

public class IntegrationRectangularMapTest {
    private final ByteArrayOutputStream outContent = new ByteArrayOutputStream();
    private final ByteArrayOutputStream errContent = new ByteArrayOutputStream();
    private final PrintStream originalOut = System.out;
    private final PrintStream originalErr = System.err;

    @Before
    public void setUpStreams() {
        System.setOut(new PrintStream(outContent));
        System.setErr(new PrintStream(errContent));
    }

    @After
    public void restoreStreams() {
        System.setOut(originalOut);
        System.setErr(originalErr);
    }

    @Test
    public void testRun(){
        String[] orders = {"f","b", "r","l","f","f","r","r","f","f","f","f","f","f","f","f"};
        MoveDirection[] directions = new OptionsParser().parse(orders);
        IWorldMap map = new RectangularMap(10, 5);
        map.place(new Animal(map));
        map.place(new Animal(map,new Vector2d(3,4)));
        map.run(directions);
        Assert.assertEquals(" y\\x  0 1 2 3 4 5 6 7 8 910\r\n" +
                "  6: -----------------------\r\n" +
                "  5: | | | | | | | | | | | |\r\n" +
                "  4: | | | |N| | | | | | | |\r\n" +
                "  3: | | |N| | | | | | | | |\r\n" +
                "  2: | | | | | | | | | | | |\r\n" +
                "  1: | | | | | | | | | | | |\r\n" +
                "  0: | | | | | | | | | | | |\r\n" +
                " -1: -----------------------\r\n" +
                "\r\n" +
                " y\\x  0 1 2 3 4 5 6 7 8 910\r\n" +
                "  6: -----------------------\r\n" +
                "  5: | | | | | | | | | | | |\r\n" +
                "  4: | | | | | | | | | | | |\r\n" +
                "  3: | | |N|N| | | | | | | |\r\n" +
                "  2: | | | | | | | | | | | |\r\n" +
                "  1: | | | | | | | | | | | |\r\n" +
                "  0: | | | | | | | | | | | |\r\n" +
                " -1: -----------------------\r\n" +
                "\r\n" +
                " y\\x  0 1 2 3 4 5 6 7 8 910\r\n" +
                "  6: -----------------------\r\n" +
                "  5: | | | | | | | | | | | |\r\n" +
                "  4: | | | | | | | | | | | |\r\n" +
                "  3: | | |E|N| | | | | | | |\r\n" +
                "  2: | | | | | | | | | | | |\r\n" +
                "  1: | | | | | | | | | | | |\r\n" +
                "  0: | | | | | | | | | | | |\r\n" +
                " -1: -----------------------\r\n" +
                "\r\n" +
                " y\\x  0 1 2 3 4 5 6 7 8 910\r\n" +
                "  6: -----------------------\r\n" +
                "  5: | | | | | | | | | | | |\r\n" +
                "  4: | | | | | | | | | | | |\r\n" +
                "  3: | | |E|W| | | | | | | |\r\n" +
                "  2: | | | | | | | | | | | |\r\n" +
                "  1: | | | | | | | | | | | |\r\n" +
                "  0: | | | | | | | | | | | |\r\n" +
                " -1: -----------------------\r\n" +
                "\r\n" +
                " y\\x  0 1 2 3 4 5 6 7 8 910\r\n" +
                "  6: -----------------------\r\n" +
                "  5: | | | | | | | | | | | |\r\n" +
                "  4: | | | | | | | | | | | |\r\n" +
                "  3: | | |E|W| | | | | | | |\r\n" +
                "  2: | | | | | | | | | | | |\r\n" +
                "  1: | | | | | | | | | | | |\r\n" +
                "  0: | | | | | | | | | | | |\r\n" +
                " -1: -----------------------\r\n" +
                "\r\n" +
                " y\\x  0 1 2 3 4 5 6 7 8 910\r\n" +
                "  6: -----------------------\r\n" +
                "  5: | | | | | | | | | | | |\r\n" +
                "  4: | | | | | | | | | | | |\r\n" +
                "  3: | | |E|W| | | | | | | |\r\n" +
                "  2: | | | | | | | | | | | |\r\n" +
                "  1: | | | | | | | | | | | |\r\n" +
                "  0: | | | | | | | | | | | |\r\n" +
                " -1: -----------------------\r\n" +
                "\r\n" +
                " y\\x  0 1 2 3 4 5 6 7 8 910\r\n" +
                "  6: -----------------------\r\n" +
                "  5: | | | | | | | | | | | |\r\n" +
                "  4: | | | | | | | | | | | |\r\n" +
                "  3: | | |S|W| | | | | | | |\r\n" +
                "  2: | | | | | | | | | | | |\r\n" +
                "  1: | | | | | | | | | | | |\r\n" +
                "  0: | | | | | | | | | | | |\r\n" +
                " -1: -----------------------\r\n" +
                "\r\n" +
                " y\\x  0 1 2 3 4 5 6 7 8 910\r\n" +
                "  6: -----------------------\r\n" +
                "  5: | | | | | | | | | | | |\r\n" +
                "  4: | | | | | | | | | | | |\r\n" +
                "  3: | | |S|N| | | | | | | |\r\n" +
                "  2: | | | | | | | | | | | |\r\n" +
                "  1: | | | | | | | | | | | |\r\n" +
                "  0: | | | | | | | | | | | |\r\n" +
                " -1: -----------------------\r\n" +
                "\r\n" +
                " y\\x  0 1 2 3 4 5 6 7 8 910\r\n" +
                "  6: -----------------------\r\n" +
                "  5: | | | | | | | | | | | |\r\n" +
                "  4: | | | | | | | | | | | |\r\n" +
                "  3: | | | |N| | | | | | | |\r\n" +
                "  2: | | |S| | | | | | | | |\r\n" +
                "  1: | | | | | | | | | | | |\r\n" +
                "  0: | | | | | | | | | | | |\r\n" +
                " -1: -----------------------\r\n" +
                "\r\n" +
                " y\\x  0 1 2 3 4 5 6 7 8 910\r\n" +
                "  6: -----------------------\r\n" +
                "  5: | | | | | | | | | | | |\r\n" +
                "  4: | | | |N| | | | | | | |\r\n" +
                "  3: | | | | | | | | | | | |\r\n" +
                "  2: | | |S| | | | | | | | |\r\n" +
                "  1: | | | | | | | | | | | |\r\n" +
                "  0: | | | | | | | | | | | |\r\n" +
                " -1: -----------------------\r\n" +
                "\r\n" +
                " y\\x  0 1 2 3 4 5 6 7 8 910\r\n" +
                "  6: -----------------------\r\n" +
                "  5: | | | | | | | | | | | |\r\n" +
                "  4: | | | |N| | | | | | | |\r\n" +
                "  3: | | | | | | | | | | | |\r\n" +
                "  2: | | | | | | | | | | | |\r\n" +
                "  1: | | |S| | | | | | | | |\r\n" +
                "  0: | | | | | | | | | | | |\r\n" +
                " -1: -----------------------\r\n" +
                "\r\n" +
                " y\\x  0 1 2 3 4 5 6 7 8 910\r\n" +
                "  6: -----------------------\r\n" +
                "  5: | | | |N| | | | | | | |\r\n" +
                "  4: | | | | | | | | | | | |\r\n" +
                "  3: | | | | | | | | | | | |\r\n" +
                "  2: | | | | | | | | | | | |\r\n" +
                "  1: | | |S| | | | | | | | |\r\n" +
                "  0: | | | | | | | | | | | |\r\n" +
                " -1: -----------------------\r\n" +
                "\r\n" +
                " y\\x  0 1 2 3 4 5 6 7 8 910\r\n" +
                "  6: -----------------------\r\n" +
                "  5: | | | |N| | | | | | | |\r\n" +
                "  4: | | | | | | | | | | | |\r\n" +
                "  3: | | | | | | | | | | | |\r\n" +
                "  2: | | | | | | | | | | | |\r\n" +
                "  1: | | | | | | | | | | | |\r\n" +
                "  0: | | |S| | | | | | | | |\r\n" +
                " -1: -----------------------\r\n" +
                "\r\n" +
                " y\\x  0 1 2 3 4 5 6 7 8 910\r\n" +
                "  6: -----------------------\r\n" +
                "  5: | | | |N| | | | | | | |\r\n" +
                "  4: | | | | | | | | | | | |\r\n" +
                "  3: | | | | | | | | | | | |\r\n" +
                "  2: | | | | | | | | | | | |\r\n" +
                "  1: | | | | | | | | | | | |\r\n" +
                "  0: | | |S| | | | | | | | |\r\n" +
                " -1: -----------------------\r\n" +
                "\r\n" +
                " y\\x  0 1 2 3 4 5 6 7 8 910\r\n" +
                "  6: -----------------------\r\n" +
                "  5: | | | |N| | | | | | | |\r\n" +
                "  4: | | | | | | | | | | | |\r\n" +
                "  3: | | | | | | | | | | | |\r\n" +
                "  2: | | | | | | | | | | | |\r\n" +
                "  1: | | | | | | | | | | | |\r\n" +
                "  0: | | |S| | | | | | | | |\r\n" +
                " -1: -----------------------\r\n" +
                "\r\n" +
                " y\\x  0 1 2 3 4 5 6 7 8 910\r\n" +
                "  6: -----------------------\r\n" +
                "  5: | | | |N| | | | | | | |\r\n" +
                "  4: | | | | | | | | | | | |\r\n" +
                "  3: | | | | | | | | | | | |\r\n" +
                "  2: | | | | | | | | | | | |\r\n" +
                "  1: | | | | | | | | | | | |\r\n" +
                "  0: | | |S| | | | | | | | |\r\n" +
                " -1: -----------------------\r\n"+"\r\n", outContent.toString());
    }
}
